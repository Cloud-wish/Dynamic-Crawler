# Websocket Server
## 如何使用
1. 使用Websocket客户端连接到`ws://{ws_host}:{ws_port}`
2. 发送初始化命令，声明该连接所属的客户端名称
3. 使用[HTTP API](https://github.com/Cloud-wish/Dynamic-Crawler/blob/main/docs/HTTP_API.md)添加所需推送
4. 接收推送消息
## 命令格式

**内容（JSON格式的文本帧）：**

| 参数名 | 类型 | 内容        | 必要性 | 备注 |
| ------ | ---- | ----------- | ------ | ---- |
| client_name | str | 客户端名称 | 必要 |      |
| type | str | 命令类型 | 必要 | `init`：初始化<br/>`exit`：断开连接 |

**回复（JSON格式的文本帧）：**

| 字段    | 类型 | 内容     | 备注                        |
| ------- | ---- | -------- | --------------------------- |
| code    | num  | 返回值   | 0：成功<br/>-1：内容非JSON<br/>>0：其它错误 |
| msg | str  | 错误信息 |                        |

## 推送消息格式

| 字段    | 类型 | 内容     | 备注                        |
| ------- | ---- | -------- | --------------------------- |
| type | str  | 推送消息的类型 |  |
| subtype | str  | 推送消息的子类型 |   |
| user | obj  | 用户信息 |   |

（其余字段根据消息类型有所不同）

`user`对象：
| 字段    | 类型 | 内容     | 备注                        |
| ------- | ---- | -------- | --------------------------- |
| uid | str  | 用户UID |  |
| name | str  | 用户名 |   |

（其余字段根据消息类型有所不同）